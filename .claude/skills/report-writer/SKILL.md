---
name: report-writer
description: |
  Use when a Digital FTE needs to synthesize verified research findings into a structured
  Markdown report with PDF export and JSON metadata (sources.json, confidence-scores.json).
  Final step in the research pipeline.
  NOT when collecting sources (use source-finder) or analyzing content (use content-analyzer).
---

# Report Writer — Report Generation Agent

## Overview

The Report Writer is a runtime skill for the Research Analyst Digital FTE. It takes verified analysis (from Fact Checker) and generates a structured Markdown research report, exports to PDF, and produces JSON metadata files (sources.json, confidence-scores.json).

## Workflow

```
Verified Analysis → Structure Report → Write Sections → Add Citations → Generate Metadata → Export PDF → Output Package
```

## Output Package

```
output/
├── research-report.md          # Main report (Markdown)
├── research-report.pdf         # PDF export
├── sources.json                # All sources with metadata
├── confidence-scores.json      # Per-finding confidence scores
└── assets/                     # Charts, figures if generated
```

## Report Structure (Markdown)

```markdown
# {Report Title}

**Date**: {date} | **Confidence**: {overall_reliability}% | **Sources**: {count}

## Executive Summary
{2-3 paragraph summary of key findings}

## Key Findings

### Finding 1: {Title}
{Detailed finding with data points}
- **Data**: {specific numbers} (Source: [{publisher}]({url}))
- **Confidence**: {score}

### Finding 2: {Title}
...

## Analysis

### {Theme 1}
{Deep dive with cross-referenced data}

### {Theme 2}
...

## Data Gaps & Limitations
- {What could not be verified}
- {Areas needing further research}

## Methodology
- Sources analyzed: {count}
- Verification method: Cross-source triangulation
- Confidence scoring: {methodology description}

## Sources
1. [{Title}]({url}) — {publisher}, {date} — Relevance: {score}
2. ...

---
*Generated by Research Analyst FTE | {timestamp}*
```

## sources.json Format

```json
{
  "sources": [
    {
      "id": "SRC-001",
      "url": "https://example.com/report",
      "title": "AI Agents Market Report 2026",
      "publisher": "Gartner",
      "date": "2026-01-15",
      "relevance_score": 0.95,
      "credibility": "high",
      "used_in_findings": ["KF-001", "KF-002"]
    }
  ],
  "total_sources": 15,
  "average_credibility": 0.82
}
```

## confidence-scores.json Format

```json
{
  "overall_reliability": 0.85,
  "per_finding": {
    "KF-001": {"score": 0.9, "verification": "verified", "sources_count": 3},
    "KF-002": {"score": 0.7, "verification": "needs_review", "sources_count": 1}
  },
  "per_question": {
    "SQ1": 0.9, "SQ2": 0.85, "SQ3": 0.7
  },
  "human_review_needed": ["KF-005", "KF-008"]
}
```

## PDF Export

Use bash to convert Markdown to PDF:
```bash
# Via pandoc (preferred)
pandoc research-report.md -o research-report.pdf --pdf-engine=xelatex

# Via weasyprint (alternative)
python -c "import markdown, weasyprint; ..."
```

## Key Rules

1. Executive Summary MUST be readable standalone (2-3 paragraphs)
2. Every data point MUST have inline citation
3. Confidence score MUST appear next to each finding
4. Data gaps section is MANDATORY — never omit limitations
5. sources.json and confidence-scores.json MUST be generated alongside report
6. PDF export MUST preserve formatting and citations
7. Report tone: professional, evidence-based, objective
